import 'package:flutter/material.dart';
import 'package:flutter_staggered_animations/flutter_staggered_animations.dart';
import 'package:pickpay/features/categories_pages/models/product_model.dart';
import 'package:pickpay/features/categories_pages/products_views/appliances_products_views/appliances_product1.dart';
import 'package:pickpay/features/categories_pages/products_views/appliances_products_views/appliances_product10.dart';
import 'package:pickpay/features/categories_pages/products_views/appliances_products_views/appliances_product11.dart';
import 'package:pickpay/features/categories_pages/products_views/appliances_products_views/appliances_product12.dart';
import 'package:pickpay/features/categories_pages/products_views/appliances_products_views/appliances_product13.dart';
import 'package:pickpay/features/categories_pages/products_views/appliances_products_views/appliances_product14.dart';
import 'package:pickpay/features/categories_pages/products_views/appliances_products_views/appliances_product15.dart';
import 'package:pickpay/features/categories_pages/products_views/appliances_products_views/appliances_product2.dart';
import 'package:pickpay/features/categories_pages/products_views/appliances_products_views/appliances_product3.dart';
import 'package:pickpay/features/categories_pages/products_views/appliances_products_views/appliances_product4.dart';
import 'package:pickpay/features/categories_pages/products_views/appliances_products_views/appliances_product5.dart';
import 'package:pickpay/features/categories_pages/products_views/appliances_products_views/appliances_product6.dart';
import 'package:pickpay/features/categories_pages/products_views/appliances_products_views/appliances_product7.dart';
import 'package:pickpay/features/categories_pages/products_views/appliances_products_views/appliances_product8.dart';
import 'package:pickpay/features/categories_pages/products_views/appliances_products_views/appliances_product9.dart';
import 'package:pickpay/features/categories_pages/products_views/beauty_products_views/beauty_product1.dart';
import 'package:pickpay/features/categories_pages/products_views/beauty_products_views/beauty_product10.dart';
import 'package:pickpay/features/categories_pages/products_views/beauty_products_views/beauty_product11.dart';
import 'package:pickpay/features/categories_pages/products_views/beauty_products_views/beauty_product12.dart';
import 'package:pickpay/features/categories_pages/products_views/beauty_products_views/beauty_product13.dart';
import 'package:pickpay/features/categories_pages/products_views/beauty_products_views/beauty_product14.dart';
import 'package:pickpay/features/categories_pages/products_views/beauty_products_views/beauty_product15.dart';
import 'package:pickpay/features/categories_pages/products_views/beauty_products_views/beauty_product16.dart';
import 'package:pickpay/features/categories_pages/products_views/beauty_products_views/beauty_product17.dart';
import 'package:pickpay/features/categories_pages/products_views/beauty_products_views/beauty_product18.dart';
import 'package:pickpay/features/categories_pages/products_views/beauty_products_views/beauty_product19.dart';
import 'package:pickpay/features/categories_pages/products_views/beauty_products_views/beauty_product2.dart';
import 'package:pickpay/features/categories_pages/products_views/beauty_products_views/beauty_product20.dart';
import 'package:pickpay/features/categories_pages/products_views/beauty_products_views/beauty_product3.dart';
import 'package:pickpay/features/categories_pages/products_views/beauty_products_views/beauty_product4.dart';
import 'package:pickpay/features/categories_pages/products_views/beauty_products_views/beauty_product5.dart';
import 'package:pickpay/features/categories_pages/products_views/beauty_products_views/beauty_product6.dart';
import 'package:pickpay/features/categories_pages/products_views/beauty_products_views/beauty_product7.dart';
import 'package:pickpay/features/categories_pages/products_views/beauty_products_views/beauty_product8.dart';
import 'package:pickpay/features/categories_pages/products_views/beauty_products_views/beauty_product9.dart';
import 'package:pickpay/features/categories_pages/products_views/home_products/home_product1.dart';
import 'package:pickpay/features/categories_pages/products_views/home_products/home_product10.dart';
import 'package:pickpay/features/categories_pages/products_views/home_products/home_product11.dart';
import 'package:pickpay/features/categories_pages/products_views/home_products/home_product12.dart';
import 'package:pickpay/features/categories_pages/products_views/home_products/home_product13.dart';
import 'package:pickpay/features/categories_pages/products_views/home_products/home_product14.dart';
import 'package:pickpay/features/categories_pages/products_views/home_products/home_product15.dart';
import 'package:pickpay/features/categories_pages/products_views/home_products/home_product16.dart';
import 'package:pickpay/features/categories_pages/products_views/home_products/home_product17.dart';
import 'package:pickpay/features/categories_pages/products_views/home_products/home_product18.dart';
import 'package:pickpay/features/categories_pages/products_views/home_products/home_product19.dart';
import 'package:pickpay/features/categories_pages/products_views/home_products/home_product2.dart';
import 'package:pickpay/features/categories_pages/products_views/home_products/home_product20.dart';
import 'package:pickpay/features/categories_pages/products_views/home_products/home_product3.dart';
import 'package:pickpay/features/categories_pages/products_views/home_products/home_product4.dart';
import 'package:pickpay/features/categories_pages/products_views/home_products/home_product5.dart';
import 'package:pickpay/features/categories_pages/products_views/home_products/home_product6.dart';
import 'package:pickpay/features/categories_pages/products_views/home_products/home_product7.dart';
import 'package:pickpay/features/categories_pages/products_views/home_products/home_product8.dart';
import 'package:pickpay/features/categories_pages/products_views/home_products/home_product9.dart';
import 'package:pickpay/features/categories_pages/products_views/product_detail_view.dart';
import 'package:pickpay/features/categories_pages/products_views/fashion_products_views/fashion_product1.dart';
import 'package:pickpay/features/categories_pages/products_views/fashion_products_views/fashion_product2.dart';
import 'package:pickpay/features/categories_pages/products_views/fashion_products_views/fashion_product3.dart';
import 'package:pickpay/features/categories_pages/products_views/fashion_products_views/fashion_product4.dart';
import 'package:pickpay/features/categories_pages/products_views/fashion_products_views/fashion_product5.dart';
import 'package:pickpay/features/categories_pages/products_views/fashion_products_views/fashion_product6.dart';
import 'package:pickpay/features/categories_pages/products_views/fashion_products_views/fashion_product7.dart';
import 'package:pickpay/features/categories_pages/products_views/fashion_products_views/fashion_product8.dart';
import 'package:pickpay/features/categories_pages/products_views/fashion_products_views/fashion_product9.dart'
    show FashionProduct9, _FashionProduct9State;
import 'package:pickpay/features/categories_pages/products_views/fashion_products_views/fashion_product10.dart';
import 'package:pickpay/features/categories_pages/products_views/fashion_products_views/fashion_product11.dart';
import 'package:pickpay/features/categories_pages/products_views/fashion_products_views/fashion_product12.dart';
import 'package:pickpay/features/categories_pages/products_views/fashion_products_views/fashion_product13.dart';
import 'package:pickpay/features/categories_pages/products_views/fashion_products_views/fashion_product14.dart';
import 'package:pickpay/features/categories_pages/products_views/fashion_products_views/fashion_product15.dart';
import 'package:pickpay/features/categories_pages/products_views/electronics_products_views/product1.dart';
import 'package:pickpay/features/categories_pages/products_views/electronics_products_views/product2.dart';
import 'package:pickpay/features/categories_pages/products_views/electronics_products_views/product10.dart';
import 'package:pickpay/features/categories_pages/products_views/electronics_products_views/product11.dart';
import 'package:pickpay/features/categories_pages/products_views/electronics_products_views/product12.dart';
import 'package:pickpay/features/categories_pages/products_views/electronics_products_views/product13.dart';
import 'package:pickpay/features/categories_pages/products_views/electronics_products_views/product14.dart';
import 'package:pickpay/features/categories_pages/products_views/electronics_products_views/product15.dart';
import 'package:pickpay/features/categories_pages/products_views/electronics_products_views/product3.dart';
import 'package:pickpay/features/categories_pages/products_views/electronics_products_views/product4.dart';
import 'package:pickpay/features/categories_pages/products_views/electronics_products_views/product5.dart';
import 'package:pickpay/features/categories_pages/products_views/electronics_products_views/product6.dart';
import 'package:pickpay/features/categories_pages/products_views/electronics_products_views/product7.dart';
import 'package:pickpay/features/categories_pages/products_views/electronics_products_views/product8.dart';
import 'package:pickpay/features/categories_pages/products_views/electronics_products_views/product9.dart';
import 'package:pickpay/features/categories_pages/products_views/video_games/video_games_product1.dart';
import 'package:pickpay/features/categories_pages/products_views/video_games/video_games_product10.dart';
import 'package:pickpay/features/categories_pages/products_views/video_games/video_games_product11.dart';
import 'package:pickpay/features/categories_pages/products_views/video_games/video_games_product12.dart';
import 'package:pickpay/features/categories_pages/products_views/video_games/video_games_product13.dart';
import 'package:pickpay/features/categories_pages/products_views/video_games/video_games_product14.dart';
import 'package:pickpay/features/categories_pages/products_views/video_games/video_games_product2.dart';
import 'package:pickpay/features/categories_pages/products_views/video_games/video_games_product3.dart';
import 'package:pickpay/features/categories_pages/products_views/video_games/video_games_product4.dart';
import 'package:pickpay/features/categories_pages/products_views/video_games/video_games_product5.dart';
import 'package:pickpay/features/categories_pages/products_views/video_games/video_games_product6.dart';
import 'package:pickpay/features/categories_pages/products_views/video_games/video_games_product7.dart';
import 'package:pickpay/features/categories_pages/products_views/video_games/video_games_product8.dart';
import 'package:pickpay/features/categories_pages/products_views/video_games/video_games_product9.dart';

class RelatedProducts extends StatelessWidget {
  final ProductsViewsModel currentProduct;

  const RelatedProducts({
    super.key,
    required this.currentProduct,
  });

  ProductsViewsModel _getProductFromWidget(
      BuildContext context, Widget widget) {
    // Fashion products
    if (widget is FashionProduct1) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is FashionProduct2) {
      final colorImages = {
        'Power Pink': [
          'assets/Fashion_products/Women_Fashion/women_fashion2/1.png',
          'assets/Fashion_products/Women_Fashion/women_fashion2/2.png',
          'assets/Fashion_products/Women_Fashion/women_fashion2/3.png',
        ],
        'Sky Tint': [
          'assets/Fashion_products/Women_Fashion/women_fashion2/sky_tint/1.png',
          'assets/Fashion_products/Women_Fashion/women_fashion2/sky_tint/2.png',
        ],
        'Core Black': [
          'assets/Fashion_products/Women_Fashion/women_fashion2/core_black/1.png',
        ],
      };

      return ProductsViewsModel(
        id: '682b00c26977bd89257c0e8f',
        title: 'adidas womens ULTIMASHOW Shoes',
        imagePaths: colorImages['Power Pink'],
        colorImages: colorImages,
        price: 2600,
        originalPrice: 2750,
        rating: 4.4,
        reviewCount: 252,
        category: 'Fashion',
        subcategory: "Women's Fashion",
        colorOptions: [
          'Power Pink',
          'Cloud White',
          'Sky Tint',
          'Core Black',
        ],
        colorAvailability: {
          'Power Pink': true,
          'Cloud White': true,
          'Sky Tint': true,
          'Core Black': false,
        },
        availableSizes: [
          '37',
          '38',
          '39',
          '40',
          '41',
          '42',
        ],
        sizeAvailability: {
          '37': false,
          '38': true,
          '39': false,
          '40': true,
          '41': false,
          '42': true,
        },
        careInstruction: 'Mesh',
        soleMaterial: 'Synthetic',
        outerMaterial: 'Mesh',
        innerMaterial: 'Manmade',
        aboutThisItem: '''Jogging shoes
Lace closure
Water Type : Hot And Cold
Textile upper
REGULAR FIT''',
        deliveryDate: 'Sunday, 9 March',
        deliveryTimeLeft: '20hrs 36 mins',
        deliveryLocation: 'Egypt',
        inStock: true,
        shipsFrom: 'Pickpay Warehouse',
        soldBy: 'Pickpay Official',
      );
    }
    if (widget is FashionProduct3) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is FashionProduct4) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is FashionProduct5) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is FashionProduct6) {
      final colorImages = {
        'Navy': [
          "assets/Fashion_products/Men_Fashion/men_fashion1/navy/1.png",
        ],
        'Antracite': [
          "assets/Fashion_products/Men_Fashion/men_fashion1/antracite/antracite.jpg",
        ],
        'Grey': [
          "assets/Fashion_products/Men_Fashion/men_fashion1/grey/grey.jpg",
        ],
        'Blue': [
          "assets/Fashion_products/Men_Fashion/men_fashion1/blue/blue.jpg",
        ],
      };

      return ProductsViewsModel(
        id: '682b00c26977bd89257c0e93',
        title:
            "DeFacto Man Modern Fit Polo Neck Short Sleeve B6374AX Polo T-Shirt",
        imagePaths: colorImages['Navy'],
        colorImages: colorImages,
        availableSizes: [
          'XSmall',
          'Small',
          'Medium',
          'Large',
          'XLarge',
          'XXLarge'
        ],
        colorOptions: ['Navy', 'Antracite', 'Grey', 'Blue'],
        colorAvailability: {
          'Navy': true,
          'Antracite': true,
          'Grey': false,
          'Blue': true,
        },
        careInstruction: 'Machine washable',
        aboutThisItem: '''B6374AX
Polyester 100%
Modern Fit
Polo Neck
Short Sleeve''',
        price: 599,
        originalPrice: 640,
        rating: 5.0,
        reviewCount: 438,
        category: 'Fashion',
        subcategory: "Men's Fashion",
        deliveryDate: 'Sunday, 9 March',
        deliveryTimeLeft: '20hrs 36 mins',
        deliveryLocation: 'Egypt',
        inStock: true,
        shipsFrom: 'Pickpay',
        soldBy: 'Pickpay',
      );
    }
    if (widget is FashionProduct7) {
      final colorImages = {
        'Light Blue': [
          "assets/Fashion_products/Men_Fashion/men_fashion2/light_blue/1.png",
        ],
        'greenish blue': [
          "assets/Fashion_products/Men_Fashion/men_fashion2/greenish/1.jpg",
        ],
        'Dark Blue': [
          "assets/Fashion_products/Men_Fashion/men_fashion2/dark_blue/1.jpg",
        ],
      };

      return ProductsViewsModel(
        id: '682b00c26977bd89257c0e94',
        title: "DOTT JEANS WEAR Men's Relaxed Fit Jean",
        imagePaths: colorImages['Light Blue'],
        colorImages: colorImages,
        colorOptions: ['greenish blue', 'Dark Blue', 'Light Blue'],
        colorAvailability: {
          'Light Blue': true,
          'greenish blue': true,
          'Dark Blue': true,
        },
        availableSizes: ['29', '30', '32', '34', '36', '38'],
        sizeAvailability: {
          '29': true,
          '30': true,
          '32': true,
          '34': true,
          '36': true,
          '38': true,
        },
        closureType: 'Zipper',
        price: 799,
        originalPrice: 830,
        rating: 4.3,
        reviewCount: 16,
        category: 'Fashion',
        subcategory: "Men's Fashion",
        aboutThisItem:
            '''Relaxed Fit: These jeans offer a comfortable, relaxed fit for all-day wear.

Durable Construction: Crafted with high-quality materials for long-lasting durability.''',
        deliveryDate: 'Sunday, 9 March',
        deliveryTimeLeft: '20hrs 36 mins',
        deliveryLocation: 'Egypt',
        inStock: true,
        shipsFrom: 'Pickpay',
        soldBy: 'Pickpay',
      );
    }
    if (widget is FashionProduct8) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is FashionProduct9) {
      final colorImages = {
        'Black Full Grain': [
          "assets/Fashion_products/Men_Fashion/men_fashion4/black/1.png",
        ],
        'Green Olive Full Grain': [
          "assets/Fashion_products/Men_Fashion/men_fashion4/Olive/1.jpg",
        ],
        'Rust Full Grain': [
          "assets/Fashion_products/Men_Fashion/men_fashion4/Rust/1.jpg",
        ],
      };

      return ProductsViewsModel(
        id: '682b00c26977bd89257c0e96',
        title: "Timberland Ek Larchmont Ftm_Chelsea, Men's Boots",
        imagePaths: colorImages['Black Full Grain'],
        colorImages: colorImages,
        category: 'Fashion',
        subcategory: "Men's Fashion",
        price: 10499,
        originalPrice: 11000,
        rating: 4.3,
        reviewCount: 57,
        colorOptions: [
          'Black Full Grain',
          'Green Olive Full Grain',
          'Rust Full Grain',
        ],
        colorAvailability: {
          'Black Full Grain': true,
          'Green Olive Full Grain': true,
          'Rust Full Grain': true,
        },
        availableSizes: [
          '42 EU',
          '43 EU',
          '44 EU',
          '45 EU',
          '45.5 EU',
          '47.5 EU',
        ],
        sizeAvailability: {
          '42 EU': false,
          '43 EU': true,
          '44 EU': false,
          '45 EU': false,
          '45.5 EU': true,
          '47.5 EU': false,
        },
        materialcomposition: 'Leather',
        soleMaterial: 'Rubber',
        shaftHeight: 'Ankle',
        outerMaterial: 'Leather',
        aboutThisItem: '''Premium full grain leather upper with tonal stitching

Breathable textile lining for comfort

Durable rubber outsole for excellent traction

Classic Chelsea boot design with elastic side panels

Timberland logo detailing

Perfect for casual and semi-formal occasions''',
        deliveryDate: 'Sunday, 9 March',
        deliveryTimeLeft: '20hrs 36 mins',
        deliveryLocation: 'Egypt',
        inStock: true,
        shipsFrom: 'Pickpay',
        soldBy: 'Pickpay',
      );
    }
    if (widget is FashionProduct10) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is FashionProduct11) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is FashionProduct12) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is FashionProduct13) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is FashionProduct14) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is FashionProduct15) {
      return (widget.build(context) as ProductDetailView).product;
    }
    // Electronics products
    if (widget is Product1View) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is Product2View) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is Product3View) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is Product4View) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is Product5View) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is Product6View) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is Product7View) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is Product8View) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is Product9View) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is Product10View) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is Product11View) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is Product12View) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is Product13View) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is Product14View) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is Product15View) {
      return (widget.build(context) as ProductDetailView).product;
    }
    // Appliances products
    if (widget is AppliancesProduct1) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is AppliancesProduct2) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is AppliancesProduct3) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is AppliancesProduct4) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is AppliancesProduct5) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is AppliancesProduct6) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is AppliancesProduct7) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is AppliancesProduct8) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is AppliancesProduct9) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is AppliancesProduct10) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is AppliancesProduct11) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is AppliancesProduct12) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is AppliancesProduct13) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is AppliancesProduct14) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is AppliancesProduct15) {
      return (widget.build(context) as ProductDetailView).product;
    }
    // home
    if (widget is HomeProduct1) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is HomeProduct2) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is HomeProduct3) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is HomeProduct4) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is HomeProduct5) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is HomeProduct6) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is HomeProduct7) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is HomeProduct8) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is HomeProduct9) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is HomeProduct10) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is HomeProduct11) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is HomeProduct12) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is HomeProduct13) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is HomeProduct14) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is HomeProduct15) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is HomeProduct16) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is HomeProduct17) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is HomeProduct18) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is HomeProduct19) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is HomeProduct20) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is VideoGamesProduct1) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is VideoGamesProduct2) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is VideoGamesProduct3) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is VideoGamesProduct4) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is VideoGamesProduct5) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is VideoGamesProduct6) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is VideoGamesProduct7) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is VideoGamesProduct8) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is VideoGamesProduct9) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is VideoGamesProduct10) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is VideoGamesProduct11) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is VideoGamesProduct12) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is VideoGamesProduct13) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is VideoGamesProduct14) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is BeautyProduct1) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is BeautyProduct2) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is BeautyProduct3) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is BeautyProduct4) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is BeautyProduct5) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is BeautyProduct6) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is BeautyProduct7) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is BeautyProduct8) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is BeautyProduct9) {
      return (widget.build(context) as ProductDetailView).product;
    }

    if (widget is BeautyProduct10) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is BeautyProduct11) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is BeautyProduct12) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is BeautyProduct13) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is BeautyProduct14) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is BeautyProduct15) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is BeautyProduct16) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is BeautyProduct17) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is BeautyProduct18) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is BeautyProduct19) {
      return (widget.build(context) as ProductDetailView).product;
    }
    if (widget is BeautyProduct20) {
      return (widget.build(context) as ProductDetailView).product;
    }
    throw Exception('Unknown widget type: ${widget.runtimeType}');
  }

  List<ProductsViewsModel> _getRelatedProducts(BuildContext context) {
    final allProducts = [
      // Fashion products
      const FashionProduct1(),
      const FashionProduct2(),
      const FashionProduct3(),
      const FashionProduct4(),
      const FashionProduct5(),
      const FashionProduct6(),
      const FashionProduct7(),
      const FashionProduct8(),
      const FashionProduct9(),
      const FashionProduct10(),
      const FashionProduct11(),
      const FashionProduct12(),
      const FashionProduct13(),
      const FashionProduct14(),
      const FashionProduct15(),
      // Electronics products
      const Product1View(),
      const Product2View(),
      const Product3View(),
      const Product4View(),
      const Product5View(),
      const Product6View(),
      const Product7View(),
      const Product8View(),
      const Product9View(),
      const Product10View(),
      const Product11View(),
      const Product12View(),
      const Product13View(),
      const Product14View(),
      const Product15View(),
      //Appliances
      const AppliancesProduct1(),
      const AppliancesProduct2(),
      const AppliancesProduct3(),
      const AppliancesProduct4(),
      const AppliancesProduct5(),
      const AppliancesProduct6(),
      const AppliancesProduct7(),
      const AppliancesProduct8(),
      const AppliancesProduct9(),
      const AppliancesProduct10(),
      const AppliancesProduct11(),
      const AppliancesProduct12(),
      const AppliancesProduct13(),
      const AppliancesProduct14(),
      const AppliancesProduct15(),
      // home
      const HomeProduct1(),
      const HomeProduct2(),
      const HomeProduct3(),
      const HomeProduct4(),
      const HomeProduct5(),
      const HomeProduct6(),
      const HomeProduct7(),
      const HomeProduct8(),
      const HomeProduct9(),
      const HomeProduct10(),
      const HomeProduct11(),
      const HomeProduct12(),
      const HomeProduct13(),
      const HomeProduct14(),
      const HomeProduct15(),
      const HomeProduct16(),
      const HomeProduct17(),
      const HomeProduct18(),
      const HomeProduct19(),
      const HomeProduct20(),
      // Video games
      const VideoGamesProduct1(),
      const VideoGamesProduct2(),
      const VideoGamesProduct3(),
      const VideoGamesProduct4(),
      const VideoGamesProduct5(),
      const VideoGamesProduct6(),
      const VideoGamesProduct7(),
      const VideoGamesProduct8(),
      const VideoGamesProduct9(),
      const VideoGamesProduct10(),
      const VideoGamesProduct11(),
      const VideoGamesProduct12(),
      const VideoGamesProduct13(),
      const VideoGamesProduct14(),
      // beauty
      const BeautyProduct1(),
      const BeautyProduct2(),
      const BeautyProduct3(),
      const BeautyProduct4(),
      const BeautyProduct5(),
      const BeautyProduct6(),
      const BeautyProduct7(),
      const BeautyProduct8(),
      const BeautyProduct9(),
      const BeautyProduct10(),
      const BeautyProduct11(),
      const BeautyProduct12(),
      const BeautyProduct13(),
      const BeautyProduct14(),
      const BeautyProduct15(),
      const BeautyProduct16(),
      const BeautyProduct17(),
      const BeautyProduct18(),
      const BeautyProduct19(),
      const BeautyProduct20(),
    ];

    final products =
        allProducts.map((w) => _getProductFromWidget(context, w)).toList();

    // Fashion categories
    if (currentProduct.subcategory == "Women's Fashion") {
      return products
          .where((p) =>
              p.subcategory == "Women's Fashion" && p.id != currentProduct.id)
          .toList()
        ..shuffle();
    } else if (currentProduct.subcategory == "Men's Fashion") {
      return products
          .where((p) =>
              p.subcategory == "Men's Fashion" && p.id != currentProduct.id)
          .toList()
        ..shuffle();
    } else if (currentProduct.subcategory == "Kids' Fashion") {
      return products
          .where((p) =>
              p.subcategory == "Kids' Fashion" && p.id != currentProduct.id)
          .toList()
        ..shuffle();
    }
    // Electronics categories
    else if (currentProduct.subcategory == "Mobile & Tablets") {
      return products
          .where((p) =>
              p.subcategory == "Mobile & Tablets" && p.id != currentProduct.id)
          .toList()
        ..shuffle();
    } else if (currentProduct.subcategory == "TVs") {
      return products
          .where((p) => p.subcategory == "TVs" && p.id != currentProduct.id)
          .toList()
        ..shuffle();
    } else if (currentProduct.subcategory == 'Laptop') {
      return products
          .where((p) => p.subcategory == 'Laptop' && p.id != currentProduct.id)
          .toList()
        ..shuffle();
    }
    //Appliances
    else if (currentProduct.subcategory == 'Large Appliances') {
      return products
          .where((p) =>
              p.subcategory == 'Large Appliances' && p.id != currentProduct.id)
          .toList()
        ..shuffle();
    } else if (currentProduct.subcategory == 'Small Appliances') {
      return products
          .where((p) =>
              p.subcategory == 'Small Appliances' && p.id != currentProduct.id)
          .toList()
        ..shuffle();
    }
    //home

    else if (currentProduct.subcategory == 'Furniture') {
      return products
          .where(
              (p) => p.subcategory == 'Furniture' && p.id != currentProduct.id)
          .toList()
        ..shuffle();
    } else if (currentProduct.subcategory == 'Home Decor') {
      return products
          .where(
              (p) => p.subcategory == 'Home Decor' && p.id != currentProduct.id)
          .toList()
        ..shuffle();
    } else if (currentProduct.subcategory == 'Kitchen & Dining') {
      return products
          .where((p) =>
              p.subcategory == 'Kitchen & Dining' && p.id != currentProduct.id)
          .toList()
        ..shuffle();
    } else if (currentProduct.subcategory == 'Bath & Bedding') {
      return products
          .where((p) =>
              p.subcategory == 'Bath & Bedding' && p.id != currentProduct.id)
          .toList()
        ..shuffle();
    }
    // video games
    else if (currentProduct.subcategory == 'Console') {
      return products
          .where((p) => p.subcategory == 'Console' && p.id != currentProduct.id)
          .toList()
        ..shuffle();
    } else if (currentProduct.subcategory == 'Controllers') {
      return products
          .where((p) =>
              p.subcategory == 'Controllers' && p.id != currentProduct.id)
          .toList()
        ..shuffle();
    } else if (currentProduct.subcategory == 'Accessories') {
      return products
          .where((p) =>
              p.subcategory == 'Accessories' && p.id != currentProduct.id)
          .toList()
        ..shuffle();
    }
    // beauty
    else if (currentProduct.subcategory == 'Makeup') {
      return products
          .where((p) => p.subcategory == 'Makeup' && p.id != currentProduct.id)
          .toList()
        ..shuffle();
    } else if (currentProduct.subcategory == 'Skincare') {
      return products
          .where(
              (p) => p.subcategory == 'Skincare' && p.id != currentProduct.id)
          .toList()
        ..shuffle();
    } else if (currentProduct.subcategory == 'Haircare') {
      return products
          .where(
              (p) => p.subcategory == 'Haircare' && p.id != currentProduct.id)
          .toList()
        ..shuffle();
    } else if (currentProduct.subcategory == 'Fragrance') {
      return products
          .where(
              (p) => p.subcategory == 'Fragrance' && p.id != currentProduct.id)
          .toList()
        ..shuffle();
    }
    return [];
  }

  @override
  Widget build(BuildContext context) {
    final relatedProducts = _getRelatedProducts(context);
    if (relatedProducts.isEmpty) return const SizedBox.shrink();

    return Container(
      margin: const EdgeInsets.only(top: 16),
      child: Column(
        crossAxisAlignment: CrossAxisAlignment.start,
        children: [
          Padding(
            padding: const EdgeInsets.symmetric(horizontal: 16.0),
            child: Row(
              children: [
                Container(
                  padding: const EdgeInsets.all(8),
                  decoration: BoxDecoration(
                    color: Theme.of(context).primaryColor.withOpacity(0.1),
                    borderRadius: BorderRadius.circular(8),
                  ),
                  child: Icon(
                    Icons.local_mall_rounded,
                    color: Theme.of(context).primaryColor,
                  ),
                ),
                const SizedBox(width: 12),
                Text(
                  'Related Products',
                  style: Theme.of(context).textTheme.titleLarge?.copyWith(
                        fontWeight: FontWeight.bold,
                      ),
                ),
              ],
            ),
          ),
          const SizedBox(height: 16),
          SizedBox(
            height: 320,
            child: AnimationLimiter(
              child: ListView.builder(
                scrollDirection: Axis.horizontal,
                padding: const EdgeInsets.symmetric(horizontal: 8.0),
                itemCount: relatedProducts.length,
                itemBuilder: (context, index) {
                  final product = relatedProducts[index];
                  return AnimationConfiguration.staggeredList(
                    position: index,
                    duration: const Duration(milliseconds: 375),
                    child: SlideAnimation(
                      horizontalOffset: 50.0,
                      child: FadeInAnimation(
                        child: _RelatedProductCard(
                          product: product,
                          index: index,
                        ),
                      ),
                    ),
                  );
                },
              ),
            ),
          ),
        ],
      ),
    );
  }
}

class _RelatedProductCard extends StatefulWidget {
  final ProductsViewsModel product;
  final int index;

  const _RelatedProductCard({
    required this.product,
    required this.index,
  });

  @override
  State<_RelatedProductCard> createState() => _RelatedProductCardState();
}

class _RelatedProductCardState extends State<_RelatedProductCard> {
  @override
  Widget build(BuildContext context) {
    final isDarkMode = Theme.of(context).brightness == Brightness.dark;
    final discountPercentage = widget.product.originalPrice != null &&
            widget.product.originalPrice! > 0 &&
            widget.product.originalPrice! > widget.product.price
        ? ((widget.product.originalPrice! - widget.product.price) /
                widget.product.originalPrice! *
                100)
            .round()
        : 0;

    return GestureDetector(
      onTap: () {
        Navigator.push(
          context,
          MaterialPageRoute(
            builder: (context) => ProductDetailView(product: widget.product),
          ),
        );
      },
      child: Container(
        width: 200,
        margin: const EdgeInsets.symmetric(horizontal: 8.0, vertical: 4),
        child: Card(
          elevation: 4,
          shadowColor: Colors.black26,
          shape: RoundedRectangleBorder(
            borderRadius: BorderRadius.circular(12),
          ),
          child: Column(
            crossAxisAlignment: CrossAxisAlignment.start,
            children: [
              Stack(
                children: [
                  ClipRRect(
                    borderRadius:
                        const BorderRadius.vertical(top: Radius.circular(12)),
                    child: Hero(
                      tag:
                          'related_product_${widget.product.id}_${widget.index}',
                      child: Container(
                        padding: const EdgeInsets.all(8),
                        child: Image.asset(
                          (widget.product.imagePaths?.isNotEmpty ?? false)
                              ? widget.product.imagePaths![0]
                              : 'assets/placeholder.png',
                          height: 140,
                          width: double.infinity,
                          fit: BoxFit.contain,
                        ),
                      ),
                    ),
                  ),
                  if (discountPercentage > 0)
                    Positioned(
                      top: 8,
                      left: 8,
                      child: Container(
                        padding: const EdgeInsets.symmetric(
                          horizontal: 8,
                          vertical: 4,
                        ),
                        decoration: BoxDecoration(
                          color: Colors.red.shade600,
                          borderRadius: BorderRadius.circular(16),
                        ),
                        child: Text(
                          '$discountPercentage% OFF',
                          style: const TextStyle(
                            color: Colors.white,
                            fontSize: 12,
                            fontWeight: FontWeight.bold,
                          ),
                        ),
                      ),
                    ),
                  Positioned(
                    bottom: 8,
                    right: 8,
                    child: Container(
                      padding: const EdgeInsets.all(6),
                      decoration: BoxDecoration(
                        color: isDarkMode
                            ? Colors.grey.shade800.withOpacity(0.8)
                            : Colors.white.withOpacity(0.8),
                        borderRadius: BorderRadius.circular(20),
                      ),
                      child: Row(
                        mainAxisSize: MainAxisSize.min,
                        children: [
                          Icon(
                            Icons.star,
                            size: 16,
                            color: Colors.amber[700],
                          ),
                          const SizedBox(width: 4),
                          Text(
                            widget.product.rating.toString(),
                            style: TextStyle(
                              fontSize: 12,
                              fontWeight: FontWeight.bold,
                              color: isDarkMode ? Colors.white : Colors.black87,
                            ),
                          ),
                        ],
                      ),
                    ),
                  ),
                ],
              ),
              Expanded(
                child: Padding(
                  padding: const EdgeInsets.all(12.0),
                  child: Column(
                    crossAxisAlignment: CrossAxisAlignment.start,
                    children: [
                      Text(
                        widget.product.title,
                        maxLines: 2,
                        overflow: TextOverflow.ellipsis,
                        style: TextStyle(
                          fontWeight: FontWeight.w600,
                          fontSize: 14,
                          color: isDarkMode ? Colors.white : Colors.black87,
                        ),
                      ),
                      const Spacer(),
                      Column(
                        crossAxisAlignment: CrossAxisAlignment.start,
                        children: [
                          Row(
                            children: [
                              Flexible(
                                child: Text(
                                  'EGP ${widget.product.price.toStringAsFixed(2)}',
                                  style: TextStyle(
                                    fontWeight: FontWeight.bold,
                                    fontSize: 15,
                                    color: Theme.of(context).primaryColor,
                                  ),
                                  overflow: TextOverflow.ellipsis,
                                ),
                              ),
                            ],
                          ),
                          if (widget.product.originalPrice != null)
                            Text(
                              'EGP ${widget.product.originalPrice!.toStringAsFixed(2)}',
                              style: TextStyle(
                                decoration: TextDecoration.lineThrough,
                                color: Colors.grey[600],
                                fontSize: 11,
                              ),
                            ),
                        ],
                      ),
                      const SizedBox(height: 8),
                      Row(
                        children: [
                          Icon(
                            Icons.shopping_cart_outlined,
                            size: 14,
                            color: isDarkMode ? Colors.white70 : Colors.black54,
                          ),
                          const SizedBox(width: 4),
                          Expanded(
                            child: Text(
                              '${widget.product.reviewCount} orders',
                              style: TextStyle(
                                fontSize: 11,
                                color: isDarkMode
                                    ? Colors.white70
                                    : Colors.black54,
                              ),
                              overflow: TextOverflow.ellipsis,
                            ),
                          ),
                          Container(
                            padding: const EdgeInsets.symmetric(
                              horizontal: 6,
                              vertical: 3,
                            ),
                            decoration: BoxDecoration(
                              color: Colors.green.shade50,
                              borderRadius: BorderRadius.circular(4),
                            ),
                            child: Text(
                              'In Stock',
                              style: TextStyle(
                                fontSize: 9,
                                color: Colors.green.shade700,
                                fontWeight: FontWeight.bold,
                              ),
                            ),
                          ),
                        ],
                      ),
                    ],
                  ),
                ),
              ),
            ],
          ),
        ),
      ),
    );
  }
}
